# [Problem 1105: Filling Bookcase Shelves](https://leetcode.com/problems/filling-bookcase-shelves/description/?envType=daily-question)

## Initial thoughts (stream-of-consciousness)
- If we just place books in order without optimizing "breakpoints" (i.e., places where we'd want to put a book on the next shelf even if it could fit on the current shelf, in order to save on height later on), this would be trivial.
- My first thought is that we could organize this problem as a tree:
    - The nodes correspond to breakpoints (I guess...represented as lists?) of already-placed books
    - Once all books are placed, we should compute the height of the bookshelf, updating the current minimum as needed (initialize `minHeight = float('inf')`)
    - Problem: this tree could get very large.  E.g., if we have 5 books, then the first break could occur at any of 5 positions, not accounting for book widths: [1 | 2 3 4 5], [1 2 | 3 4 5], [1 2 3 | 4 5], [1 2 3 4 | 5], or [1 2 3 4 5].  And then the *next* break for each of those configurations could occur at any of $n$ positions (where $n$ is the number of books to the right of the break).  If we have a really long sequence of books, this could get unweildy fast.
- We could potentially do some refining:
    - If the next book to place can't fit on the shelf, then we *know* that there needs to be a breakpoint there
    - If the next book *can* fit on the shelf, then if its height is less than or equal to the current maximum height for that shelf, then we know there should *not* be a breakpoint there.
    - If the book *could* fit on the shelf, but it'd be the largest one, then we need to know whether the resulting increase in height is justified, or whether we'd be better off moving to the next shelf.
- This is making me think of a sliding window approach.  We could track two indices, $i$ (last book that has *already* been placed; initialized to 1) and $j$ (end of the current placement efforts):
    - We could probably (maybe?) make an $O(n^2)$ algorithm...which might be OK, since we know there are at most 1000 books:
        - For each book in turn (of which therere are $O(n)$), loop through all possible breakpoints of *subsequent* books (of which there are *also* $O(n)$).  And then...what?  Hmm.
        - There must be some way of deciding when no more optimization is possible-- e.g., the books up to some point have been placed and we don't need to think about anything else.
            - One idea that comes to mind is that we actually don't need to "forecast" ahead all the way to the end of the list of books.  The *most* we need to consider would be the maximum number of books that could fit on the shelf.
            - Which breakpoints do we need to consider?  Maybe we can use the cases above to prune the options?
            - But...this still seems to lead to a "tree" approach: we can't just optimize a single shelf and then move on to the next, because paying a "slightly" higher cost early on could mean we can get a larger benefit on some subsequent shelf that wouldn't have been possible otherwise.  Could we get around this...?
        - Let's go back to the $i$/$j$ idea.  Suppose $i$ is book under consideration.  What we really need to know is: going back in the list of books, up to however many would fit on the current shelf (where $i$ is), could we have moved any already-placed books to $i$'s shelf?
        - We could keep track of the current "best" achievable height when placing the first $i$ books (where everything is initialized to `float('inf')` and then we need to update the "best heights" if we ever find better breakpoints while placing a future book).
            - I'm assuming we will never need to "go back" *further* than whatever can fit on the current shelf.  That seems to hold at least for the given examples, but maybe it'd be possible to encounter a book sequence where going back *futher* would be useful (maybe...even all the way back to the very first book)?
- Ok, so (ignoring the "go back to the beginning" possbility) this is tentatively feeling like a dynamic programming problem.  Let's try it.

## Refining the problem, round 2 thoughts
- We should start by initializing `min_heights = [float('inf') * (len(books) + 1)]` and then setting `min_heights[0] = 0`.  This first entry stores the height after placing "0" books.  `min_heights[-1]` will be the value we return, after placing all `len(books)` books.
- For each book `i` in turn (1-indexed):
    - Let's keep track of the current shelf (we need its `width` and `height`; initialize these both to 0)
    - Looping backwards from `i` (let's call the new index `j`)-- i.e., `for j in range(i - 1, -1, -1)`:
        - Add the width of book `j` to `width`.  If we've exceeded `shelfWidth`, then break.
        - Update the current height (for this shelf) to `max(height, <book j's height>)`
        - If `min_heights[i] > min_heights[j] + height`, replace `min_heights[i]` with `min_heights[j] + height` (i.e., move those previously placed books to the current shelf)
- Let's try this...

## Attempted solution(s)
```python
class Solution:
    def minHeightShelves(self, books: List[List[int]], shelfWidth: int) -> int:
        min_heights = [float('inf')] * (len(books) + 1)
        min_heights[0] = 0

        for i in range(1, len(books) + 1):
            width, height = 0, 0
            for j in range(i - 1, -1, -1):
                width += books[j][0]
                if width > shelfWidth:
                    break
                height = max(height, books[j][1])
                min_heights[i] = min(min_heights[i], min_heights[j] + height)

        return min_heights[-1]
```
- Given test cases pass
- I'll make up some new test cases by randomly generating book thicknesses and widths:
    - `books = [[985, 305], [113, 327], [506, 224], [260, 50], [85, 30], [733, 111], [173, 78], [786, 940], [385, 985], [548, 44], [324, 439], [275, 606], [581, 377], [171, 646], [95, 39], [126, 813], [383, 739], [600, 431], [489, 479], [457, 627], [709, 147], [290, 603], [31, 614], [362, 324], [82, 247], [778, 519], [202, 490], [28, 99], [760, 29], [700, 363], [871, 689], [345, 585], [80, 450], [252, 650], [316, 541], [516, 350], [588, 969], [209, 692], [177, 674], [100, 441], [169, 132], [365, 511], [308, 729], [621, 56], [519, 401], [417, 905], [125, 636], [256, 498], [667, 746], [955, 712], [485, 932], [261, 484], [552, 109], [875, 766], [668, 520], [415, 1000], [889, 151], [428, 924], [104, 448], [909, 505], [419, 993], [93, 983], [128, 574], [293, 598], [54, 756], [417, 844], [754, 272], [452, 964], [284, 727], [244, 637], [197, 996], [950, 519], [923, 169], [680, 469], [208, 744], [829, 74], [498, 66], [22, 675], [409, 283], [920, 767], [637, 542], [747, 780], [97, 178], [194, 422], [244, 513], [751, 803], [162, 878], [205, 342], [493, 916], [518, 109], [463, 753], [19, 32], [65, 817], [227, 345], [226, 721], [17, 978], [867, 883], [426, 786], [523, 278], [43, 760]]`, `shelf_width = 1000`: pass
    - `books = [[600, 256], [944, 22], [442, 316], [493, 696], [679, 285], [975, 388], [856, 113], [732, 563], [310, 415], [225, 453], [396, 356], [763, 361], [214, 403], [162, 407], [831, 540], [489, 830], [227, 530], [928, 491], [989, 798], [369, 137], [938, 635], [366, 937], [660, 342], [89, 762], [223, 711], [779, 833], [420, 136], [928, 730], [94, 547], [535, 624], [203, 926], [28, 211], [388, 172], [764, 471], [978, 463], [119, 593], [1, 466], [255, 290], [31, 717], [441, 239], [987, 9], [372, 8], [855, 268], [471, 142], [854, 660], [952, 585], [804, 899], [597, 940], [743, 415], [59, 517], [861, 906], [223, 985], [916, 352], [258, 268], [158, 742], [642, 702], [689, 359], [446, 873], [800, 707], [779, 383], [206, 156], [391, 956], [643, 419], [856, 315], [137, 281], [875, 397], [866, 946], [756, 252], [770, 736], [162, 109], [973, 938], [848, 554], [735, 594], [287, 922], [37, 522], [909, 258], [746, 69], [455, 64], [393, 614], [447, 670], [865, 214], [78, 3], [776, 960], [385, 184], [5, 759], [291, 496], [693, 187], [244, 265], [307, 443], [679, 90], [323, 101], [386, 13], [198, 776], [528, 507], [52, 381], [9, 702], [41, 28], [115, 253], [799, 966], [428, 858], [524, 915], [375, 646], [896, 722], [369, 48], [513, 38], [911, 780], [131, 555], [404, 802], [235, 114], [340, 668], [855, 737], [944, 824], [904, 865], [281, 88], [417, 741], [910, 169], [922, 454], [559, 561], [869, 876], [491, 408], [596, 326], [905, 625], [540, 813], [198, 132], [202, 109], [511, 108], [717, 427], [783, 980], [416, 286], [556, 574], [415, 445], [13, 364], [59, 769], [274, 650], [145, 2], [589, 931], [73, 728], [353, 464], [430, 337], [553, 693], [601, 248], [25, 599], [454, 966], [527, 22], [697, 321], [320, 203], [371, 91], [293, 775], [591, 489], [260, 214], [888, 946], [596, 178], [214, 652], [240, 385], [792, 823], [652, 287], [580, 110], [707, 478], [571, 779], [763, 525], [559, 418], [431, 168], [718, 380], [617, 392], [406, 57], [322, 105], [181, 736], [439, 220], [127, 914], [114, 66], [281, 578], [257, 66], [970, 107], [164, 37], [66, 200], [695, 761], [514, 701], [432, 77], [57, 133], [586, 58], [575, 927], [3, 869], [992, 233], [362, 992], [715, 450], [430, 619], [251, 708], [18, 257], [26, 726], [24, 583], [183, 6], [925, 291], [751, 701], [830, 48], [274, 167], [820, 64], [330, 970], [224, 314], [957, 873], [846, 575], [153, 231], [84, 869], [506, 690], [130, 976], [126, 856], [486, 676], [856, 879], [869, 138], [380, 606], [998, 793], [642, 678], [982, 630], [194, 242], [323, 663], [221, 94], [667, 713], [329, 21], [883, 79], [447, 366], [689, 120], [727, 136], [429, 815], [20, 32], [375, 862], [557, 103], [666, 388], [102, 440], [272, 489], [70, 459], [889, 324], [59, 896], [967, 732], [756, 897], [932, 977], [450, 708], [377, 415], [378, 158], [972, 974], [712, 210], [604, 877], [719, 580], [564, 981], [172, 727], [498, 44], [170, 390], [509, 428], [235, 961], [726, 494], [512, 23], [375, 786], [21, 77], [537, 24], [852, 879], [769, 751], [154, 957], [345, 682], [560, 6], [593, 514], [912, 860], [512, 19], [465, 217], [162, 444], [528, 246], [864, 750], [901, 412], [62, 395], [994, 860], [91, 991], [232, 261], [429, 290], [644, 917], [421, 390], [805, 904], [934, 739], [428, 797], [187, 932], [472, 835], [735, 584], [593, 309], [318, 641], [557, 757], [402, 526], [290, 163], [870, 622], [532, 936], [541, 77], [556, 567], [278, 232], [637, 740], [408, 756], [143, 870], [215, 715], [373, 23], [113, 238], [439, 173], [729, 998], [463, 880], [292, 189], [428, 920], [678, 315], [372, 193], [421, 788], [451, 104], [427, 244], [341, 737], [695, 102], [261, 133], [451, 420], [227, 657], [74, 96], [98, 104], [623, 191], [59, 586], [565, 207], [684, 501], [561, 65], [89, 74], [89, 476], [497, 750], [47, 724], [712, 874], [304, 480], [654, 649], [292, 434], [501, 419], [854, 30], [710, 449], [813, 208], [301, 37], [578, 626], [73, 796], [460, 804], [733, 607], [532, 198], [804, 173], [837, 823], [553, 660], [275, 533], [249, 836], [80, 429], [587, 325], [568, 339], [470, 828], [847, 664], [985, 189], [771, 721], [462, 798], [804, 175], [319, 827], [524, 225], [399, 114], [790, 119], [351, 680], [547, 162], [345, 213], [934, 686], [467, 495], [212, 152], [6, 845], [844, 99], [530, 69], [363, 320], [704, 864], [439, 41], [946, 68], [114, 419], [231, 523], [795, 860], [825, 225], [613, 371], [894, 579], [789, 401], [924, 495], [420, 371], [568, 405], [58, 278], [90, 893], [19, 841], [851, 790], [786, 195], [331, 124], [124, 823], [839, 616], [192, 883], [731, 4], [888, 705], [88, 196], [80, 650], [813, 78], [586, 76], [428, 589], [99, 231], [625, 464], [283, 237], [750, 146], [319, 911], [722, 318], [258, 589], [27, 894], [243, 219], [487, 972], [552, 988], [583, 35], [754, 242], [762, 841], [561, 953], [184, 894], [559, 761], [403, 274], [941, 84], [119, 497], [677, 565], [185, 227], [905, 85], [866, 309], [668, 973], [341, 972], [567, 520], [421, 689], [247, 257], [631, 377], [678, 386], [677, 300], [394, 114], [888, 232], [533, 100], [970, 919], [519, 115], [122, 42], [354, 496], [799, 663], [8, 458], [459, 219], [996, 508], [654, 793], [538, 677], [206, 850], [35, 265], [839, 875], [411, 821], [220, 634], [783, 528], [916, 857], [685, 357], [791, 527], [862, 294], [567, 141], [402, 2], [199, 840], [17, 299], [772, 25], [593, 881], [476, 384], [720, 355], [543, 351], [448, 542], [48, 983], [578, 596], [913, 407], [773, 205], [456, 525], [450, 463], [714, 172], [290, 90], [865, 500], [830, 942], [32, 266], [700, 141], [832, 371], [201, 562], [19, 203], [116, 985], [258, 402], [797, 544], [124, 302], [410, 243], [618, 229], [974, 598], [952, 268], [346, 740], [367, 124], [543, 21], [319, 303], [118, 631], [983, 230], [562, 397], [104, 426], [164, 333], [299, 786], [76, 29], [866, 877], [534, 827], [470, 688], [176, 597], [972, 968], [735, 443], [148, 323], [329, 626], [236, 539], [446, 137], [296, 913], [671, 966], [787, 896], [584, 895], [461, 449], [644, 464], [675, 456], [229, 621], [144, 116], [898, 273], [746, 750], [598, 756], [493, 943], [773, 958], [139, 56], [434, 231], [888, 979], [723, 196], [564, 865], [878, 684], [88, 238], [276, 619], [754, 958], [171, 326], [835, 644], [45, 633], [593, 335], [634, 596], [20, 103], [593, 777], [212, 734], [213, 764], [270, 723], [804, 28], [799, 29], [750, 724], [285, 832], [625, 576], [748, 948], [152, 544], [559, 691], [941, 280], [420, 594], [225, 741], [173, 115], [806, 689], [807, 330], [2, 698], [842, 258], [44, 133], [109, 561], [774, 831], [894, 590], [215, 565], [623, 987], [21, 200], [433, 283], [237, 594], [664, 766], [920, 89], [150, 877], [944, 240], [767, 297], [854, 255], [24, 930], [174, 989], [386, 941], [60, 114], [577, 331], [481, 321], [274, 364], [60, 643], [772, 617], [512, 525], [220, 959], [819, 210], [845, 654], [540, 564], [504, 622], [215, 792], [164, 776], [925, 819], [709, 843], [270, 864], [604, 554], [29, 379], [29, 944], [434, 914], [352, 530], [294, 235], [866, 78], [414, 374], [96, 930], [909, 686], [397, 324], [779, 245], [142, 437], [336, 958], [263, 797], [427, 376], [832, 720], [79, 147], [451, 508], [883, 601], [909, 53], [963, 461], [860, 657], [519, 357], [359, 939], [466, 810], [210, 137], [558, 588], [816, 222], [168, 82], [842, 948], [350, 760], [522, 820], [100, 731], [376, 769], [806, 276], [83, 655], [736, 10], [98, 201], [598, 745], [557, 120], [156, 133], [182, 100], [885, 883], [450, 50], [103, 237], [512, 586], [417, 246], [479, 717], [732, 20], [309, 796], [707, 740], [879, 954], [712, 797], [539, 69], [686, 463], [260, 208], [487, 246], [585, 371], [443, 466], [564, 291], [986, 633], [888, 954], [132, 16], [238, 318], [620, 194], [891, 983], [8, 323], [744, 620], [252, 589], [98, 460], [906, 971], [438, 327], [777, 919], [128, 697], [410, 561], [347, 716], [778, 538], [295, 577], [752, 670], [268, 619], [966, 758], [497, 50], [841, 829], [23, 824], [307, 3], [468, 428], [181, 858], [43, 33], [526, 744], [570, 118], [196, 64], [273, 78], [392, 844], [959, 313], [841, 344], [434, 85], [636, 6], [77, 771], [161, 825], [421, 634], [163, 713], [397, 412], [185, 792], [21, 169], [944, 43], [137, 10], [481, 144], [261, 621], [985, 724], [131, 568], [211, 834], [848, 263], [965, 470], [497, 173], [190, 253], [159, 220], [218, 374], [615, 276], [153, 550], [483, 996], [434, 593], [374, 496], [354, 106], [410, 45], [835, 535], [869, 761], [881, 788], [965, 717], [230, 421], [983, 194], [587, 586], [312, 62], [444, 714], [948, 350], [464, 676], [352, 504], [230, 664], [317, 473], [428, 778], [315, 848], [991, 666], [42, 810], [45, 305], [707, 287], [856, 973], [380, 972], [132, 862], [781, 391], [109, 84], [806, 522], [672, 669], [110, 497], [329, 161], [747, 552], [854, 628], [488, 58], [543, 873], [972, 198], [52, 494], [658, 290], [457, 834], [347, 903], [756, 478], [882, 812], [200, 100], [501, 649], [962, 722], [471, 847], [564, 806], [888, 440], [849, 285], [483, 95], [578, 90], [533, 321], [586, 817], [655, 114], [746, 587], [60, 121], [958, 739], [139, 944], [295, 544], [602, 764], [533, 91], [665, 520], [574, 760], [430, 121], [774, 216], [266, 8], [27, 51], [351, 867], [419, 176], [701, 844], [278, 81], [171, 945], [284, 836], [27, 873], [830, 627], [215, 782], [61, 734], [929, 848], [505, 100], [496, 208], [233, 539], [179, 546], [584, 301], [13, 108], [96, 869], [722, 805], [571, 477], [946, 369], [499, 173], [609, 538], [279, 416], [740, 423], [301, 69], [629, 781], [545, 692], [494, 535], [96, 594], [426, 657], [377, 256], [755, 484], [694, 852], [511, 812], [521, 674], [553, 162], [428, 932], [339, 852], [287, 592], [103, 946], [266, 202], [146, 391], [593, 267], [515, 636], [122, 733], [376, 163], [211, 897], [653, 911], [897, 795], [110, 851], [896, 307], [78, 467], [871, 694], [10, 615], [195, 170], [244, 509], [217, 669], [817, 157], [621, 559], [503, 624], [86, 591], [834, 894], [435, 468], [307, 164], [381, 223], [671, 986], [961, 341], [788, 911], [601, 120], [784, 246], [348, 943], [716, 952], [294, 615], [793, 874], [94, 137], [622, 697], [481, 885], [689, 457], [760, 906], [968, 900], [232, 176], [261, 903], [205, 997], [328, 631], [271, 499], [649, 843], [993, 218], [503, 899], [44, 818], [791, 174], [814, 208], [345, 939], [716, 671], [356, 578], [486, 307], [731, 796], [236, 480], [276, 206], [410, 599], [360, 385], [802, 51], [251, 397], [965, 652], [979, 164], [953, 281], [320, 426], [460, 813], [464, 212], [726, 718], [910, 487], [470, 870], [562, 595], [188, 315], [437, 510], [796, 382], [489, 447], [234, 364], [133, 741], [482, 963], [231, 407], [793, 120], [835, 544], [567, 366], [87, 120], [318, 557], [861, 47], [569, 310], [60, 61], [534, 211], [609, 216], [217, 922], [232, 570], [666, 325], [964, 530], [231, 426], [895, 959], [211, 56], [910, 924], [979, 467], [759, 971], [972, 155], [707, 137], [754, 96], [616, 699], [381, 28], [191, 909], [101, 502], [949, 370], [356, 906], [844, 649], [174, 889], [827, 527], [142, 451], [850, 911], [139, 966], [342, 757], [70, 697], [507, 978], [176, 239], [705, 250], [948, 88], [586, 661], [491, 84], [464, 293], [252, 866], [505, 184], [420, 89], [851, 245], [476, 98], [626, 809], [815, 986], [474, 999], [490, 438], [755, 850], [242, 882], [345, 871], [307, 104], [426, 308], [595, 381], [202, 406], [429, 242], [271, 92], [516, 843], [697, 379], [686, 494], [61, 661], [938, 972], [652, 595], [8, 932], [821, 218], [731, 522], [474, 125], [250, 276], [697, 51], [844, 140], [635, 204], [429, 615], [619, 446], [440, 515], [728, 652], [642, 785], [198, 175], [579, 537], [159, 588], [294, 801], [983, 692], [37, 872], [801, 320], [458, 333], [224, 327], [398, 174], [316, 474], [980, 523], [354, 51], [955, 95], [388, 130], [673, 598], [158, 841], [310, 18], [214, 603], [358, 803], [597, 929], [150, 829], [922, 978], [774, 728]]`, `shelfWidth = 1000`: pass
- Seems ok-- submitting!  (So...I guess the "looping back to the beginning" issue isn't a problem?)

![Screenshot 2024-07-30 at 11 01 36 PM](https://github.com/user-attachments/assets/25d7bb5a-a492-4374-88cb-7655ce2cb8cf)

Yay, that's all of the daily problems for July, 2024 🥳 🏆 🏅 🧑‍💻!

![Screenshot 2024-07-30 at 11 01 03 PM](https://github.com/user-attachments/assets/925d39a3-e273-4678-a52c-34fc97c4eddb)

